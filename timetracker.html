<html>

<head>
    <script>
        
let t = setInterval(showTime, 500)

function showTime() {
    let today = new Date();
    let h = today.getHours();
    let m = today.getMinutes();
    let s = today.getSeconds();
    m = checkTime(m);
    s = checkTime(s);
    if (sCount % 2 == 1) {
        document.getElementById('clock').innerHTML = h + ":" + m + ":" + s;
    }
    if (sCount % 2 == 0) {
        clearInterval(t);
        t = setInterval(showTime, 15000);
        document.getElementById('clock').innerHTML = h + ":" + m;
    }
}
function checkTime(i) {
    if (i < 10) {i = "0" + i};
    return i;
}

function toggleSeconds() {
    sCount++;
    if (sCount % 2 == 0) {
        clearInterval(t);
        t = setInterval(showTime, 100);
    }
    else {
        clearInterval(t);
        t = setInterval(showTime, 500);
    }
}

let startMin = 0,
    endMin = 0,
    totalMin = 0,
    totalHrs = 0,
    count = -1,
    dispCount = 1,
    oCount = 1,
    sCount = 1,
    timeArray = [],
    timeArrayString = [],
    noteArray = [],
    dispTimeMins = 0,
    dispTimeHrs = 0,
    dispTimeStr = "",
    pctWork = 0;

function displayTimeAndComment(){
    let note = document.getElementById("text").value;
    let e1 =  document.getElementById('note');
    if(count < 0){
        e1.textContent = "";
    }
    if (note == "") {
        note = "stuff";
    }
    count++;
    let d = new Date();
        h = d.getHours(),
        m = d.getMinutes(),
        hrs = (h + (m/60)),
        mins = h*60 + m;
        
    timeArray[count] = hrs;
    dispTimeHrs = Math.floor(hrs);
    dispTimeMins = Math.round((hrs - dispTimeHrs) * 60);
    dispTimeStr = createTimeString(dispTimeHrs, dispTimeMins);
    timeArrayString[count] = dispTimeStr;

    if(count>=0){
        summarizeDay();
    }

    if (count % 2 == 0) {
        e1.innerHTML += dispCount + " : ";
        dispCount++;
    }

    e1.innerHTML += timeArrayString[count] + " ";
   
    if(isEven(count)){
        noteArray[count] = note;
        startMin = mins;
    }
    else{
        endMin = mins;
        let sectionMins = endMin - startMin;
        noteArray[count] = sectionMins;
        e1.innerHTML += noteArray[count-1] + " for: " +  " " + noteArray[count] + " mins <br />" ;
        totalMin = totalMin + sectionMins;
    }

}

function printNotes(){
    let line = 1;
    let totalLines = Math.ceil(timeArray.length/2)
    let e1 =  document.getElementById('note');
    e1.innerHTML = "";
    for(line=1; line <= totalLines; line++){
        //interpolation?
        e1.innerHTML +=  line + ' : ' + timeArrayString[line*2-2] + " " + timeArrayString[line*2-1] + " " + noteArray[line*2-2] + ' for: ' + noteArray[line*2-1] + ' mins';
        e1.innerHTML += "<br />";
    }
}

function overrideTime() {
    //need error message for time that doesn't make sense
    if (isEven(oCount)) {
        let e2 = document.getElementById('editinfo');
        let newHour = parseFloat(document.getElementById("orhrs").value);
        let newIndex = parseInt(document.getElementById('ordex').value);
        timeArray[newIndex] = newHour;
        let hrs = newHour;
        dispTimeHrs = Math.floor(hrs);
        dispTimeMins = Math.round((hrs - dispTimeHrs) * 60);
        dispTimeStr = createTimeString(dispTimeHrs, dispTimeMins);
        timeArrayString[newIndex] = dispTimeStr;

        if(isEven(newIndex)){
            let newSectionMins = (timeArray[newIndex+1]-timeArray[newIndex]) * 60;
            noteArray[newIndex+1] = newSectionMins;
        }
        else{
            let newSectionMins = (timeArray[newIndex]-timeArray[newIndex-1]) * 60;
            noteArray[newIndex] = newSectionMins;
        }

        let editedLine = 0;
        if (isEven(newIndex)) {
            editedLine = (newIndex + 2) / 2;
        }
        else {
            editedLine = (newIndex + 1) / 2;
        }
        e2.innerHTML += "LINE " + editedLine + " HAS BEEN EDITED" + "<br />";

        printNotes();
        summarizeDay();

        document.getElementById('orindex').style.display = "none";
        document.getElementById('orhours').style.display = "none";
        document.getElementById('orhelp').style.display = "none";
    }
    else{
        document.getElementById('orindex').style.display = "block";
        document.getElementById('orhours').style.display = "block";
        document.getElementById('orhelp').style.display = "block";
    }

    oCount++;

}

function clearText(){
    //fix this
    totalHrs = getHrs();
    let e1 = document.getElementById('note');
    let e2 = document.getElementById('editinfo')
    let e4 = document.getElementById('xx');
    e1.textContent = totalMin + " minutes" + " " + "Edited: " + totalHrs + " hours";
    e2.textContent = "[ ]";
    e3.textContent = "";
    
    startMin = 0;
    endMin = 0;
    totalMin = 0;
    totalHrs = 0;
    count = -1;
    timeArray = [];
    timeArrayString = [];
    noteArray = [];
    dispTimeMins = 0,
    dispTimeHrs = 0,
    dispTimeStr = "",
    pctWork = 0;
}

function summarizeDay(){
    let e3 = document.getElementById('summary');
    totalHrs = getHrs();
    pctWork = getPercent(totalHrs).toFixed(2);
    e3.textContent = "Summary: " + (totalHrs).toFixed(2) + " hours" + " Percent: " + pctWork;
    totalHrs = 0;

}

function getHrs(){
    total = 0;
    let i = timeArray.length;
        while(i>1){
            if(!isEven(i)){
                i = i - 1;
            }
            total += timeArray[i-1] - timeArray[i-2];
            i = i - 2;
        }
    return total;
}

function getPercent(tw){

    let i = timeArray.length - 1;
    let pct = 0;
    pct = ((tw)/(timeArray[i]-timeArray[0]))*100
    if(tw == 0){
        return 0;
    }
    return pct;
}

function createTimeString(h, m){
    if (m < 10){
        return h + ":" + "0" + m;
    }
    else{
        return h + ":" + m;
    }
}



function hideElements(){
    document.getElementById('orbutton').style.backgroundColor = "red";
    document.getElementById('orindex').style.display = "none";
    document.getElementById('orhours').style.display = "none";
    document.getElementById('orhelp').style.display = "none";
}

function isEven(value){
    if(value%2 == 0)
        return true;
    else
        return false; 
}



    </script>
    <style>


    </style>
</head>

<body onload="showTime(); hideElements();">
    <button id="secbutton" onclick="toggleSeconds()">Seconds</button>
    <h1 id="clock"></h1>

    <button onclick="displayTimeAndComment()">Enter</button>
    <button onclick="clearText()">Clear</button>
    <button id="orbutton" onclick="overrideTime()">Override</button>
    <form id="textfield" autocomplete="off">
        <input type="text" id="text" value="" />
    </form>
    <div id=summary>Summary: </div><br />
    <div id="note"></div>
    <div id="xx"></div>
    <div id="xxx"></div>


    <div id="editinfo"></div>
    <div id="orhelp">Index, Value</div>
    <div style="display: flex;">
        <form id="orindex">
            <input type="number" id="ordex" value="" />
        </form>
        <form id="orhours">
            <input type="number" id="orhrs" value="" />
        </form>
    </div>





</body>

</html>