<html>

<head>
    <script>

function showTime() {
  let today = new Date();
  let h = today.getHours();
  let m = today.getMinutes();
  let s = today.getSeconds();
  m = checkTime(m);
  s = checkTime(s);
  document.getElementById('clock').innerHTML =
  h + ":" + m + ":" + s;
  let t = setTimeout(showTime, 500);

}
function checkTime(i) {
  if (i < 10) {i = "0" + i};  // add zero in front of numbers < 10
  return i;
}

//initialize variables
let startMin = 0,
    endMin = 0,
    totalMin = 0,
    totalHrs = 0,
    count = -1,
    timeArray = [],
    timeArrayString = [],
    dispTimeMins = 0,
    dispTimeHrs = 0,
    dispTimeStr = "",
    pctWork = 0;

function displayTimeAndComment(){
    let note = document.getElementById("text").value;
    let e1 =  document.getElementById('note');
    let e2 = document.getElementById('timearray');
    if(count < 0){
        e1.textContent = "";
    }
    count++;
    let d = new Date();
    let h = d.getHours();
    let m = d.getMinutes();
    let hrs = (h + (m/60));
    let mins = h*60 + m;

    timeArray[count] = hrs;
    dispTimeHrs = Math.floor(hrs);
    dispTimeMins = Math.round((hrs - dispTimeHrs) * 60);
    dispTimeStr = createTimeString(dispTimeHrs, dispTimeMins);
    timeArrayString[count] = dispTimeStr;

    e2.textContent = "";
    for(i = 0; i <= count; i++){
        e2.textContent += timeArrayString[i] + "    ";
    }
    
    e1.textContent  += timeArrayString[count];
   // e1.textContent +=  note;
    e1.textContent += "\r\n";

    if(count%2 === 0){
        startMin = mins;
    }
    else{
        debugger;
        endMin = mins;
        let sectionMins = endMin - startMin;
        e1.textContent += "<" + note + " " + sectionMins + "> "
      
     //find a way to add as a <br> instead
        
        totalMin = totalMin + endMin - startMin;
    }
    
}

function overrideTime(){
    let e1 = document.getElementById('timearray');
    let newHour = document.getElementById("orhrs").value;
    let newIndex = document.getElementById('ordex').value;
    timeArray[newIndex] = newHour;

    let hrs = newHour;
    dispTimeHrs = Math.floor(hrs);
    dispTimeMins = Math.round((hrs - dispTimeHrs) * 60);
    dispTimeStr = createTimeString(dispTimeHrs, dispTimeMins);
    timeArrayString[newIndex] = dispTimeStr;
    e1.textContent = "";
    for(i = 0; i <= count; i++){
        e1.textContent += timeArrayString[i] + "    ";
    }
    

}


function clearText(){
    totalHrs = getHrs();
    let e1 = document.getElementById('note');
    let e2 = document.getElementById('xx');
    let e3 = document.getElementById('timearray')
    e1.textContent = totalMin + " minutes" + " " + "Edited: " + totalHrs + " hours";
    e2.textContent = "";
    e3.textContent = "[ ]";
    startMin = 0;
    endMin = 0;
    totalMin = 0;
    totalHrs = 0;
    count = -1;
    timeArray = [];
    timeArrayString = [];
    dispTimeMins = 0,
    dispTimeHrs = 0,
    dispTimeStr = "",
    pctWork = 0;
}



function summarizeDay(){
    let e1 = document.getElementById('summary');
    totalHrs = getHrs()
    pctWork = getPercent(totalHrs);
    totalHrs = totalHrs.toFixed(2);

    e1.textContent = "Summary: " + (totalMin/60).toFixed(5) + " hours" + " " + "Edited: " + totalHrs + " hours Percent: " + pctWork;
    totalHrs = 0;

}

function getHrs(){
    totalHrs = 0;
    let i = timeArray.length - 1;

    while(i>-1){
        
        if(i%2 === 0){
            i = i - 1;
        }
        totalHrs += timeArray[i] - timeArray[i-1];
        i = i - 2;
    }
    console.log(totalHrs);
    return totalHrs;
}

function getPercent(tw){

    let i = timeArray.length - 1;
    let pct = 0;
   
    pct = ((tw)/(timeArray[i]-timeArray[0]))*100
    return pct;
}

function createTimeString(h, m){
    if (m < 10){
        return h + ":" + "0" + m;
    }
    else{
        return h + ":" + m;
    }
}

    </script>
    <style>


    </style>
</head>

<body onload="showTime()">
    <h1 id="clock"></h1>
    <div id="note">Click Enter to Start</div>
    <div id="xx"></div>
    <div id="xxx"></div>

    <button onclick="displayTimeAndComment()">Enter</button>
    <button onclick="clearText()">Clear</button>
  <!--  <button onclick="endTime()">End</button>-->
    <button onclick="summarizeDay()">Summarize</button>


    <form id="textfield">
            <input type ="text" id="text" value="" />
    </form>
    <div id="timearray">[ ]</div>
    <div>Index, Value</div>
    <div style="display: flex;">
            <form id="orindex">
                    <input type = "number" id="ordex" value="" />
            </form>
            <form id="orhours">
                    <input type ="number" id="orhrs" value="" />
                </form>
           </div>
    

    <button onclick="overrideTime()">Override</button>
    <div id=summary>Summary: </div>


    
</body>

</html>