<html>

<head>
    <script>
        
let t = setInterval(showTime, 500)

function showTime() {
    console.log('hi');
    let today = new Date();
    let h = today.getHours();
    let m = today.getMinutes();
    let s = today.getSeconds();
    m = checkTime(m);
    s = checkTime(s);
    if (sCount % 2 == 1) {
        document.getElementById('clock').innerHTML = h + ":" + m + ":" + s;
    }
    if (sCount % 2 == 0) {
        clearInterval(t);
        t = setInterval(showTime, 15000);
        document.getElementById('clock').innerHTML = h + ":" + m;
    }
}
function checkTime(i) {
    if (i < 10) {i = "0" + i};
    return i;
}

function toggleSeconds() {
    sCount++;
    if (sCount % 2 == 0) {
        clearInterval(t);
        t = setInterval(showTime, 100);
    }
    else {
        clearInterval(t);
        t = setInterval(showTime, 500);
    }
}

let startMin = 0,
    endMin = 0,
    totalMin = 0,
    totalHrs = 0,
    count = -1,
    dispCount = 1,
    oCount = 1,
    sCount = 1,
    timeArray = [],
    timeArrayString = [],
    dispTimeMins = 0,
    dispTimeHrs = 0,
    dispTimeStr = "",
    pctWork = 0;

function displayTimeAndComment(){
    if(count >= 0){
        summarizeDay();
    }
    let note = document.getElementById("text").value;
    let e1 =  document.getElementById('note');
    if(count < 0){
        e1.textContent = "";
    }
    if (note == "") {
        note = "Default";
    }
    count++;
    let d = new Date();
    let h = d.getHours();
    let m = d.getMinutes();
    let hrs = (h + (m/60));
    let mins = h*60 + m;

    timeArray[count] = hrs;
    dispTimeHrs = Math.floor(hrs);
    dispTimeMins = Math.round((hrs - dispTimeHrs) * 60);
    dispTimeStr = createTimeString(dispTimeHrs, dispTimeMins);
    timeArrayString[count] = dispTimeStr;

    if (count % 2 == 0) {
        e1.innerHTML += dispCount + " : ";
        dispCount++;
    }
    e1.innerHTML += timeArrayString[count] + " ";
   

    if(count%2 === 0){
        startMin = mins;
    }
    else{
        endMin = mins;
        let sectionMins = endMin - startMin;
        e1.innerHTML += note + " for: " +  " " + sectionMins + " mins <br />" ;
        totalMin = totalMin + sectionMins;
    }
    
}
function overrideTime() {
    if (oCount % 3 == 1) {
        document.getElementById('orindex').style.display = "block";
        document.getElementById('orhours').style.display = "block";
        document.getElementById('orhelp').style.display = "block";
    }
    if (oCount % 3 == 0) {
        document.getElementById('orindex').style.display = "none";
        document.getElementById('orhours').style.display = "none";
        document.getElementById('orhelp').style.display = "none";
    }
    if (oCount % 3 == 2) {
        
        let e2 = document.getElementById('editinfo');
        let newHour = document.getElementById("orhrs").value;
        let newIndex = document.getElementById('ordex').value;
        timeArray[newIndex] = newHour;
        let hrs = newHour;
        console.log(typeof (hrs));
        dispTimeHrs = Math.floor(hrs);
        dispTimeMins = Math.round((hrs - dispTimeHrs) * 60);
        dispTimeStr = createTimeString(dispTimeHrs, dispTimeMins);
        timeArrayString[newIndex] = dispTimeStr;
        let editedLine = 0;
        newIndex = parseFloat(newIndex);
        if (newIndex % 2 == 0) {
            editedLine = (newIndex + 2) / 2;
        }
        else {
            editedLine = (newIndex + 1) / 2;
        }
        e2.textContent = "LINE " + editedLine + " HAS BEEN EDITED";
    }

    oCount++;

}


function clearText(){
    totalHrs = getHrs();
    let e1 = document.getElementById('note');
    let e2 = document.getElementById('editinfo')
    let e4 = document.getElementById('xx');
    e1.textContent = totalMin + " minutes" + " " + "Edited: " + totalHrs + " hours";
    e2.textContent = "[ ]";
    e3.textContent = "";
    
    startMin = 0;
    endMin = 0;
    totalMin = 0;
    totalHrs = 0;
    count = -1;
    timeArray = [];
    timeArrayString = [];
    dispTimeMins = 0,
    dispTimeHrs = 0,
    dispTimeStr = "",
    pctWork = 0;
}



function summarizeDay(){
    let e3 = document.getElementById('summary');
    totalHrs = getHrs()
    pctWork = getPercent(totalHrs);
    totalHrs = totalHrs.toFixed(2);

    e3.textContent = "Summary: " + (totalMin / 60).toFixed(2) + " hours" + " Percent: " + pctWork;
    totalHrs = 0;

}

function getHrs(){
    totalHrs = 0;
    let i = timeArray.length - 1;

    while(i>-1){
        
        if(i%2 === 0){
            i = i - 1;
        }
        totalHrs += timeArray[i] - timeArray[i-1];
        i = i - 2;
    }
    return totalHrs;
}

function getPercent(tw){

    let i = timeArray.length - 1;
    let pct = 0;
   
    pct = ((tw)/(timeArray[i]-timeArray[0]))*100
    return pct;
}

function createTimeString(h, m){
    if (m < 10){
        return h + ":" + "0" + m;
    }
    else{
        return h + ":" + m;
    }
}

function hideElements(){
    document.getElementById('orbutton').style.backgroundColor = "red";
    document.getElementById('orindex').style.display = "none";
    document.getElementById('orhours').style.display = "none";
    document.getElementById('orhelp').style.display = "none";
}

    </script>
    <style>


    </style>
</head>

<body onload="showTime(); hideElements();">
    <button id="secbutton" onclick="toggleSeconds()">Seconds</button>
    <h1 id="clock"></h1>

    <button onclick="displayTimeAndComment()">Enter</button>
    <button onclick="clearText()">Clear</button>
    <button id="orbutton" onclick="overrideTime()">Override</button>
    <form id="textfield" autocomplete="off">
        <input type="text" id="text" value="" />
    </form>
    <div id=summary>Summary: </div><br />
    <div id="note"></div>
    <div id="xx"></div>
    <div id="xxx"></div>


    <div id="editinfo">++</div>
    <div id="orhelp">Index, Value</div>
    <div style="display: flex;">
        <form id="orindex">
            <input type="number" id="ordex" value="" />
        </form>
        <form id="orhours">
            <input type="number" id="orhrs" value="" />
        </form>
    </div>





</body>

</html>